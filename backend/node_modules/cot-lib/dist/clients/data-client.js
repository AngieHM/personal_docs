"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Observable_1 = require("rxjs/Observable");
var axios_1 = require("axios");
var util_1 = require("../util");
var internal_utils_1 = require("../internal-utils");
var URLSearchParams = require('url-search-params');
var DataClient = /** @class */ (function () {
    function DataClient(host, axiosInstance) {
        this.host = host;
        this.ax = axiosInstance || axios_1.default.create();
    }
    DataClient.prototype.generateLatestUrls = function (metric) {
        var _this = this;
        return this.getMultiItems().map(function (item) { return _this.host + _this.getBaseApiPath(item) + '/' + metric + '/events/latest'; });
    };
    DataClient.prototype.generateEventUrls = function (metric, queryStr) {
        var _this = this;
        return this.getMultiItems().map(function (item) { return _this.host + _this.getBaseApiPath(item) + '/' + metric + '/events' + ((queryStr && queryStr.length > 0) ? '?' + queryStr : ''); });
    };
    DataClient.prototype.generateStatsUrls = function (metric, type, timeStr) {
        var _this = this;
        return this.getMultiItems().map(function (item) { return _this.host + _this.getBaseApiPath(item) + '/' + metric + '/stats/' + type + '/' + timeStr; });
    };
    /**
     * Methods for retrieving data of a particual metric
     * @param metric metric name
     */
    DataClient.prototype.getData = function (metric) {
        var that = this;
        return {
            latest: function () {
                return Observable_1.Observable.merge.apply(Observable_1.Observable, that.generateLatestUrls(metric).map(function (url) { return internal_utils_1.InternalUtils.getAsTemporalPage(url, that.ax); }));
            },
            poll: function (period, fromTS) {
                var last;
                var queryStr = new URLSearchParams();
                if (fromTS) {
                    queryStr.append('from', fromTS.toString());
                }
                return Observable_1.Observable.merge.apply(Observable_1.Observable, that.generateEventUrls(metric, queryStr.toString())
                    .map(function (url) { return internal_utils_1.InternalUtils.getAsTemporalPage(url, that.ax)
                    .delay(period)
                    .expand(function (tpage) {
                    if (!!tpage.link.next) {
                        var t = internal_utils_1.InternalUtils.getLastTimestamp(tpage);
                        last = t == null ? last : t;
                        // console.log(last);
                        return internal_utils_1.InternalUtils.getAsTemporalPage(that.host + tpage.link.next, that.ax, last).delay(period);
                    }
                    else {
                        return Observable_1.Observable.empty();
                    }
                }); }));
            },
            range: function (fromTS, toTS) {
                var queryStr = new URLSearchParams();
                queryStr.append('from', fromTS.toString());
                queryStr.append('to', toTS.toString());
                return Observable_1.Observable
                    .merge.apply(Observable_1.Observable, that.generateEventUrls(metric, queryStr.toString()).map(function (url) { return internal_utils_1.InternalUtils.getCompleteInterval(that.host, url, that.ax); })).filter(function (page) { return Object.keys(page.data).length > 0; });
                // .pluck('data');
            }
        };
    };
    ;
    /**
     * Methods for retrieving statistics of a particular metric
     */
    DataClient.prototype.getStats = function (metric) {
        var that = this;
        return {
            getUnit: function () {
                return {
                    getHour: function (hourTS) {
                        return Observable_1.Observable.merge.apply(Observable_1.Observable, that.generateStatsUrls(metric, 'unit', util_1.Util.Time.getHourStr(hourTS)).map(function (url) { return internal_utils_1.InternalUtils.getAsTemporalPage(url, that.ax); }));
                    },
                    getHourRange: function (fromTS, toTS) {
                        return that.getStats(metric).getUnit().getHour(fromTS).expand(function (tpage) {
                            var url = tpage.link.next;
                            if (tpage.link.self.endsWith(util_1.Util.Time.getHourStr(toTS))) {
                                return Observable_1.Observable.empty();
                            }
                            else {
                                return internal_utils_1.InternalUtils.getAsTemporalPage(that.host + url, that.ax);
                            }
                        });
                    },
                    getHourRecap: function (fromTS, toTS) {
                        return that.getStats(metric).getUnit().getHourRange(fromTS, toTS)
                            .filter(function (o) { return !o.data.nodata; })
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsData(acc, curr); });
                    },
                    getHourRecapOf: function () {
                        var hourTS = [];
                        for (var _i = 0; _i < arguments.length; _i++) {
                            hourTS[_i] = arguments[_i];
                        }
                        return Observable_1.Observable.from(hourTS).flatMap(function (ts) { return that.getStats(metric).getUnit().getHour(ts); })
                            .filter(function (o) { return !o.data.nodata; })
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsData(acc, curr); });
                    },
                    getDay: function (dayTS) {
                        return Observable_1.Observable.merge.apply(Observable_1.Observable, that.generateStatsUrls(metric, 'unit', util_1.Util.Time.getDayStr(dayTS)).map(function (url) { return internal_utils_1.InternalUtils.getAsTemporalPage(url, that.ax); }));
                    },
                    getDayRange: function (fromTS, toTS) {
                        return that.getStats(metric).getUnit().getDay(fromTS).expand(function (tpage) {
                            var url = tpage.link.next;
                            if (tpage.link.self.endsWith(util_1.Util.Time.getDayStr(toTS))) {
                                return Observable_1.Observable.empty();
                            }
                            else {
                                return internal_utils_1.InternalUtils.getAsTemporalPage(that.host + url, that.ax);
                            }
                        });
                    },
                    getDayRecap: function (fromTS, toTS) {
                        return that.getStats(metric).getUnit().getDayRange(fromTS, toTS)
                            .filter(function (o) { return !o.data.nodata; })
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsData(acc, curr); });
                    },
                    getDayRecapOf: function () {
                        var dayTS = [];
                        for (var _i = 0; _i < arguments.length; _i++) {
                            dayTS[_i] = arguments[_i];
                        }
                        return Observable_1.Observable.from(dayTS).flatMap(function (ts) { return that.getStats(metric).getUnit().getDay(ts); })
                            .filter(function (o) { return !o.data.nodata; })
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsData(acc, curr); });
                    },
                };
            },
            getBatch: function () {
                return {
                    getDay: function (dayTS) {
                        return Observable_1.Observable.merge.apply(Observable_1.Observable, that.generateStatsUrls(metric, 'batch', util_1.Util.Time.getDayStr(dayTS))
                            .map(function (url) { return internal_utils_1.InternalUtils.getAsTemporalPage(url, that.ax).filter(function (res) { return Object.keys(res.data).length > 0; }); }));
                    },
                    getDayRange: function (fromTS, toTS) {
                        return that.getStats(metric).getBatch().getDay(fromTS).expand(function (tpage) {
                            var url = tpage.link.next;
                            if (tpage.link.self.endsWith(util_1.Util.Time.getDayStr(toTS))) {
                                return Observable_1.Observable.empty();
                            }
                            else {
                                return internal_utils_1.InternalUtils.getAsTemporalPage(that.host + url, that.ax);
                            }
                        });
                    },
                    getDayRecap: function (fromTS, toTS) {
                        return that.getStats(metric).getBatch().getDayRange(fromTS, toTS)
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsBatchedData(acc, curr); });
                    },
                    getDayRecapOf: function () {
                        var dayTS = [];
                        for (var _i = 0; _i < arguments.length; _i++) {
                            dayTS[_i] = arguments[_i];
                        }
                        return Observable_1.Observable.from(dayTS).flatMap(function (ts) { return that.getStats(metric).getBatch().getDay(ts); })
                            .map(function (o) { return o.data; })
                            .reduce(function (acc, curr) { return internal_utils_1.InternalUtils.mergeStatsBatchedData(acc, curr); });
                    },
                };
            }
        };
    };
    return DataClient;
}());
exports.DataClient = DataClient;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1jbGllbnQuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvdGR1cG9udC9Xb3Jrc3BhY2VzL2NvdC1saWIvbGliLyIsInNvdXJjZXMiOlsiY2xpZW50cy9kYXRhLWNsaWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDhDQUE2QztBQUM3QywrQkFBMEI7QUFHMUIsZ0NBQStCO0FBQy9CLG9EQUE0RDtBQUc1RCxJQUFJLGVBQWUsR0FBRyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUVuRDtJQUdJLG9CQUFZLElBQVksRUFBRSxhQUE0QjtRQUNsRCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsRUFBRSxHQUFHLGFBQWEsSUFBSSxlQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDOUMsQ0FBQztJQWFPLHVDQUFrQixHQUExQixVQUEyQixNQUFjO1FBQXpDLGlCQUVDO1FBREcsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxLQUFJLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLE1BQU0sR0FBRyxnQkFBZ0IsRUFBdkUsQ0FBdUUsQ0FBQyxDQUFDO0lBQ3JILENBQUM7SUFFTyxzQ0FBaUIsR0FBekIsVUFBMEIsTUFBYyxFQUFFLFFBQWdCO1FBQTFELGlCQUVDO1FBREcsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxLQUFJLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLE1BQU0sR0FBRyxTQUFTLEdBQUcsQ0FBQyxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdB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